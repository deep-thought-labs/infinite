# Creating a Genesis File for New Networks

**Objective**: Create a customized genesis file for a new Infinite Drive network (mainnet, testnet, or creative) with accounts and validators.

**‚ö†Ô∏è IMPORTANT**: 
- This guide is **specifically for mainnet/testnet/creative creation** (one-time setup process)
- **Regular users** running local development chains should use `local_node.sh` instead, which handles genesis customization automatically

---

## Quick Start: Essential Steps

Follow these steps in order to create your genesis file:

### Step 1: Initialize Genesis

   ```bash
# Initialize the chain with a moniker and chain ID
infinited init my-moniker --chain-id infinite_421018-1 --home ~/.infinited
```

**What this does**: Creates a basic genesis file with default Cosmos SDK values (uses "stake" denomination - will be customized in next step).

---

### Step 2: Apply Infinite Drive Customizations

**‚ö†Ô∏è REQUIRED**: The genesis generated by `infinited init` uses default Cosmos SDK values. You must apply Infinite Drive customizations.

<details>
<summary><strong>Mainnet</strong> (click to expand)</summary>

   ```bash
./scripts/customize_genesis.sh ~/.infinited/config/genesis.json --network mainnet
```

**Network configuration**:
- Base denom: `drop`
- Display denom: `Improbability`
- Symbol: `42`
- Production-ready parameters

</details>

<details>
<summary><strong>Testnet</strong> (click to expand)</summary>

   ```bash
./scripts/customize_genesis.sh ~/.infinited/config/genesis.json --network testnet
```

**Network configuration**:
- Base denom: `tdrop`
- Display denom: `TestImprobability`
- Symbol: `T42`
- Testing-optimized parameters

</details>

<details>
<summary><strong>Creative</strong> (click to expand)</summary>

   ```bash
./scripts/customize_genesis.sh ~/.infinited/config/genesis.json --network creative
```

**Network configuration**:
- Base denom: `cdrop`
- Display denom: `CreativeImprobability`
- Symbol: `C42`
- Minimal fees, free-play parameters

</details>

**What this script does**:
- ‚úÖ Sets all module denominations to network-specific denom
- ‚úÖ Adds complete token metadata
- ‚úÖ Configures EVM precompiles and ERC20 pairs
- ‚úÖ Sets consensus, staking, mint, governance, slashing, fee market, and distribution parameters
- ‚úÖ Creates automatic backup

**Configuration files location**:
The script reads all network-specific parameters from JSON configuration files located in:
- **Mainnet**: `scripts/genesis-configs/mainnet.json`
- **Testnet**: `scripts/genesis-configs/testnet.json`
- **Creative**: `scripts/genesis-configs/creative.json`

These files contain all network-specific parameters (denominations, token metadata, staking, mint, governance, slashing, fee market, distribution, and consensus parameters). You can modify these files to customize the genesis parameters for each network.

**For ModuleAccounts vesting configuration**:
- **Mainnet**: `scripts/genesis-configs/mainnet-vesting.json`
- **Testnet**: `scripts/genesis-configs/testnet-vesting.json`
- **Creative**: `scripts/genesis-configs/creative-vesting.json`

---

### Step 3: Configure ModuleAccounts with Vesting (Optional)

<details>
<summary><strong>Click to expand if you need ModuleAccounts with vesting</strong></summary>

If you need to set up ModuleAccounts with linear vesting (e.g., treasury, development, community pools):

```bash
# Generate commands for ModuleAccounts vesting setup
./scripts/setup_module_accounts.sh --network mainnet --genesis-dir ~/.infinited

# The script will print commands like:
# infinited genesis add-module-vesting-account treasury \
#   --module-name treasury \
#   --vesting-amount 1000000000000000000000000drop \
#   --vesting-start-time 1735689600 \
#   --vesting-end-time 2208988800 \
#   --permissions minter,burner \
#   --home ~/.infinited
```

**What to do**:
1. Run the script to see the generated commands
2. Copy and paste each command in the order shown
3. The script does NOT execute commands automatically - you must run them manually

**When to use**: Setting up treasury accounts, development funds, or community pools with vesting schedules.

**When NOT to use**: If you don't need ModuleAccounts with vesting, or for regular user accounts (use Step 4 instead).

</details>

---

### Step 4: Create and Fund Accounts

#### 4.1: Create Account

```bash
# Create a new account in the keyring
infinited keys add my-account --keyring-backend file --home ~/.infinited
```

**‚ö†Ô∏è SECURITY**: Save the mnemonic phrase securely. You'll need it to recover the account.

**Alternative: Recover from mnemonic**:
```bash
infinited keys add my-account --recover --keyring-backend file --home ~/.infinited
```

#### 4.2: Fund Account in Genesis

```bash
# Add the account to genesis with initial balance (example: 100 tokens)
infinited genesis add-genesis-account my-account 100000000000000000000drop \
  --keyring-backend file \
  --home ~/.infinited
```

**Amount format**: Use atomic units (multiply by 10^18). Always include the denom suffix: `drop` (mainnet), `tdrop` (testnet), or `cdrop` (creative).

**Examples** (all using 100 tokens = 100 * 10^18):

<details>
<summary><strong>Mainnet Example</strong> (click to expand)</summary>

```bash
# Fund with 100 tokens (mainnet)
infinited genesis add-genesis-account my-account 100000000000000000000drop \
  --keyring-backend file --home ~/.infinited
```

Amount: `100000000000000000000drop` = 100 Improbability tokens (100 √ó 10^18)

</details>

<details>
<summary><strong>Testnet Example</strong> (click to expand)</summary>

```bash
# Fund with 100 tokens (testnet)
infinited genesis add-genesis-account my-account 100000000000000000000tdrop \
  --keyring-backend file --home ~/.infinited
```

Amount: `100000000000000000000tdrop` = 100 TestImprobability tokens (100 √ó 10^18)

</details>

<details>
<summary><strong>Creative Example</strong> (click to expand)</summary>

```bash
# Fund with 100 tokens (creative)
infinited genesis add-genesis-account my-account 100000000000000000000cdrop \
  --keyring-backend file --home ~/.infinited
```

Amount: `100000000000000000000cdrop` = 100 CreativeImprobability tokens (100 √ó 10^18)

</details>

<details>
<summary><strong>Multiple Accounts</strong> (click to expand)</summary>

```bash
# Create and fund multiple accounts (each with 100 tokens)
infinited keys add account1 --keyring-backend file --home ~/.infinited
infinited genesis add-genesis-account account1 100000000000000000000drop \
  --keyring-backend file --home ~/.infinited

infinited keys add account2 --keyring-backend file --home ~/.infinited
infinited genesis add-genesis-account account2 100000000000000000000drop \
  --keyring-backend file --home ~/.infinited
```

**Note**: Replace `drop` with `tdrop` for testnet or `cdrop` for creative network.

</details>

---

### Step 5: Create Validator

#### 5.1: Create Validator Genesis Transaction (gentx)

```bash
# Create a gentx for the validator (example: self-delegate 1 token)
infinited genesis gentx my-account 1000000000000000000drop \
  --chain-id infinite_421018-1 \
  --commission-rate "0.10" \
  --commission-max-rate "0.20" \
  --commission-max-change-rate "0.01" \
  --min-self-delegation "1000000000000000000" \
  --keyring-backend file \
  --home ~/.infinited
```

**Parameters**:
- `my-account`: Account name (must exist in keyring and have funds in genesis)
- `1000000000000000000drop`: Amount to self-delegate (1 token = 1 √ó 10^18, must be ‚â§ account balance)
- `--chain-id`: Must match the chain ID used in `infinited init`
- `--commission-rate`: Initial commission (e.g., 10% = "0.10")
- `--commission-max-rate`: Maximum commission (e.g., 20% = "0.20")
- `--commission-max-change-rate`: Max change per update (e.g., 1% = "0.01")
- `--min-self-delegation`: Minimum tokens to self-delegate (in atomic units, example: 1 token = "1000000000000000000")

**Optional metadata**:
```bash
infinited genesis gentx my-account 1000000000000000000drop \
  --chain-id infinite_421018-1 \
  --moniker "My Validator" \
  --website "https://myvalidator.com" \
  --details "Validator description" \
  --security-contact "security@myvalidator.com" \
  --commission-rate "0.10" \
  --commission-max-rate "0.20" \
  --commission-max-change-rate "0.01" \
  --min-self-delegation "1000000000000000000" \
  --keyring-backend file \
  --home ~/.infinited
```

#### 5.2: Collect Genesis Transactions

```bash
# Collect all gentx files into genesis
infinited genesis collect-gentxs --home ~/.infinited
```

**‚ö†Ô∏è IMPORTANT**: 
- The chain **requires at least one validator** in genesis to produce blocks
- If you don't run `collect-gentxs`, the chain will start but won't produce blocks
- All validators must use the same `--chain-id`

<details>
<summary><strong>Multiple Validators Setup</strong> (click to expand)</summary>

For networks with multiple validators:

1. **Each validator creates their gentx** (on their own machine):
   ```bash
   # Validator 1 (example: self-delegate 1 token)
   infinited genesis gentx validator1 1000000000000000000drop \
     --chain-id infinite_421018-1 \
     --commission-rate "0.10" \
     --commission-max-rate "0.20" \
     --commission-max-change-rate "0.01" \
     --min-self-delegation "1000000000000000000" \
     --keyring-backend file \
     --home ~/.infinited
   
   # Validator 2 (on different machine, example: self-delegate 1 token)
   infinited genesis gentx validator2 1000000000000000000drop \
     --chain-id infinite_421018-1 \
     --commission-rate "0.10" \
     --commission-max-rate "0.20" \
     --commission-max-change-rate "0.01" \
     --min-self-delegation "1000000000000000000" \
     --keyring-backend file \
     --home ~/.infinited
   ```

2. **Copy all gentx files to coordinator** (files are in `~/.infinited/config/gentx/`)
3. **Coordinator collects all gentxs**:
   ```bash
   infinited genesis collect-gentxs --home ~/.infinited
   ```
4. **Distribute final genesis** to all validators

**Important**: All validators must use the **exact same chain ID**.

</details>

---

### Step 6: Validate Genesis

```bash
# Validate the genesis file
infinited genesis validate-genesis --home ~/.infinited
```

**This checks**:
- ‚úÖ All denominations are consistent
- ‚úÖ Total supply equals sum of balances
- ‚úÖ Validator configurations are correct
- ‚úÖ JSON structure is valid

---

### Step 7: Distribute Genesis File

The finalized `genesis.json` must be distributed to **ALL nodes** in the network before launch:

```bash
# Copy genesis to all validator nodes
scp ~/.infinited/config/genesis.json user@validator1:/path/to/.infinited/config/
scp ~/.infinited/config/genesis.json user@validator2:/path/to/.infinited/config/
```

**‚ö†Ô∏è CRITICAL**: All nodes must use the **exact same** `genesis.json` file. Any difference will cause the network to fork.

---

### Step 8: Start the Network

<details>
<summary><strong>Mainnet</strong> (click to expand)</summary>

```bash
infinited start \
  --chain-id infinite_421018-1 \
  --evm.evm-chain-id 421018 \
  --home ~/.infinited
```

</details>

<details>
<summary><strong>Testnet</strong> (click to expand)</summary>

```bash
infinited start \
  --chain-id infinite_421018001-1 \
  --evm.evm-chain-id 421018001 \
  --home ~/.infinited
```

</details>

<details>
<summary><strong>Creative</strong> (click to expand)</summary>

```bash
infinited start \
  --chain-id infinite_421018002-1 \
  --evm.evm-chain-id 421018002 \
  --home ~/.infinited
```

</details>

**Always specify both Chain IDs**:
- `--chain-id`: Cosmos Chain ID (format: `{name}_{number}-{version}`)
- `--evm.evm-chain-id`: EVM Chain ID (integer, EIP-155)

---

## Complete Examples

<details>
<summary><strong>Mainnet Complete Example</strong> (click to expand)</summary>

```bash
# Step 1: Initialize
infinited init mainnet-validator --chain-id infinite_421018-1 --home ~/.infinited

# Step 2: Apply customizations
./scripts/customize_genesis.sh ~/.infinited/config/genesis.json --network mainnet

# Step 3: Create validator account
infinited keys add validator --keyring-backend file --home ~/.infinited
# Save the mnemonic securely!

# Step 4: Fund validator account (100 tokens)
infinited genesis add-genesis-account validator 100000000000000000000drop \
  --keyring-backend file --home ~/.infinited

# Step 5: Create gentx (self-delegate 1 token)
infinited genesis gentx validator 1000000000000000000drop \
  --chain-id infinite_421018-1 \
  --moniker "Mainnet Validator" \
  --commission-rate "0.10" \
  --commission-max-rate "0.20" \
  --commission-max-change-rate "0.01" \
  --min-self-delegation "1000000000000000000" \
  --keyring-backend file \
  --home ~/.infinited

# Step 6: Collect gentx
infinited genesis collect-gentxs --home ~/.infinited

# Step 7: Validate
infinited genesis validate-genesis --home ~/.infinited

# Step 8: Distribute genesis.json to all nodes, then start
infinited start --chain-id infinite_421018-1 --evm.evm-chain-id 421018 --home ~/.infinited
```

</details>

<details>
<summary><strong>Testnet Complete Example</strong> (click to expand)</summary>

```bash
# Step 1: Initialize
infinited init testnet-validator --chain-id infinite_421018001-1 --home ~/.infinited

# Step 2: Apply customizations
./scripts/customize_genesis.sh ~/.infinited/config/genesis.json --network testnet

# Step 3: Create validator account
infinited keys add validator --keyring-backend file --home ~/.infinited
# Save the mnemonic securely!

# Step 4: Fund validator account (100 tokens)
infinited genesis add-genesis-account validator 100000000000000000000tdrop \
  --keyring-backend file --home ~/.infinited

# Step 5: Create gentx (self-delegate 1 token)
infinited genesis gentx validator 1000000000000000000tdrop \
  --chain-id infinite_421018001-1 \
  --moniker "Testnet Validator" \
  --commission-rate "0.10" \
  --commission-max-rate "0.20" \
  --commission-max-change-rate "0.01" \
  --min-self-delegation "1000000000000000000" \
  --keyring-backend file \
  --home ~/.infinited

# Step 6: Collect gentx
infinited genesis collect-gentxs --home ~/.infinited

# Step 7: Validate
infinited genesis validate-genesis --home ~/.infinited

# Step 8: Distribute genesis.json to all nodes, then start
infinited start --chain-id infinite_421018001-1 --evm.evm-chain-id 421018001 --home ~/.infinited
```

</details>

<details>
<summary><strong>Creative Complete Example</strong> (click to expand)</summary>

```bash
# Step 1: Initialize
infinited init creative-validator --chain-id infinite_421018002-1 --home ~/.infinited

# Step 2: Apply customizations
./scripts/customize_genesis.sh ~/.infinited/config/genesis.json --network creative

# Step 3: Create validator account
infinited keys add validator --keyring-backend file --home ~/.infinited
# Save the mnemonic securely!

# Step 4: Fund validator account (100 tokens)
infinited genesis add-genesis-account validator 100000000000000000000cdrop \
  --keyring-backend file --home ~/.infinited

# Step 5: Create gentx (self-delegate 1 token)
infinited genesis gentx validator 1000000000000000000cdrop \
  --chain-id infinite_421018002-1 \
  --moniker "Creative Validator" \
  --commission-rate "0.01" \
  --commission-max-rate "0.05" \
  --commission-max-change-rate "0.01" \
  --min-self-delegation "1000000000000000000" \
  --keyring-backend file \
  --home ~/.infinited

# Step 6: Collect gentx
infinited genesis collect-gentxs --home ~/.infinited

# Step 7: Validate
infinited genesis validate-genesis --home ~/.infinited

# Step 8: Distribute genesis.json to all nodes, then start
infinited start --chain-id infinite_421018002-1 --evm.evm-chain-id 421018002 --home ~/.infinited
```

</details>

---

## Additional Resources

For detailed information about genesis parameters, module configurations, and technical background:

- üìñ **[Genesis Reference Guide](GENESIS_REFERENCE.md)** - Complete technical reference for all genesis parameters, modules, and configurations
- üîß **Scripts Documentation**: See `guides/development/SCRIPTS.md` for detailed script documentation
- üöÄ **Production Guide**: See `guides/deployment/PRODUCTION.md` for production deployment considerations
- üìö **External Resources**:
- [Cosmos SDK Genesis Documentation](https://docs.cosmos.network/main/building-modules/genesis)
- [CometBFT Genesis Documentation](https://docs.cometbft.com/v0.38/core/genesis)

---

**Note**: For local development, use `local_node.sh` instead, which handles all genesis customization automatically.
